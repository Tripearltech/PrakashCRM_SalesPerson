﻿@model PrakashCRM.Data.Models.SPCompanyContact
@{
    ViewBag.Title = "CompanyContactCard";
    Layout = "~/Views/Shared/_SalespersonMasterLayout.cshtml";
}

<style>
    .verticalScroll {
        padding: 15px;
        overflow-y: auto;
        height: 310px;
    }

    .EditContactCls, .DeleteContactCls,
    DeleteContactProdCls:hover {
        cursor: pointer;
    }
</style>

<div class="page-content">
    <div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3">
        <div class="ps-3">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb mb-0 p-0">
                    <li class="breadcrumb-item">
                        <a href="/SPDashboard/Index"><i class="bx bx-tachometer"></i>&nbsp;Dashboard</a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="/SPContacts/ContactCompanyList"> Contact List </a>
                    </li>
                    <li class="breadcrumb-item active" aria-current="page">
                        Contact Card
                    </li>
                </ol>
            </nav>
        </div>
    </div>
    <hr />

    <div class="card">
        <div class="card-body">

            @using (Html.BeginForm("CompanyContactCard", "SPContacts", FormMethod.Post))
            {
                @Html.ValidationSummary(true)
                <div class="row">
                    <div>
                        <h6 class="mb-0 font-weight-bold">General</h6>
                        <hr />

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Company Name<span class="required" style="color:red;margin-left:2px">*</span></label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.Company_Name, new { Value = Model.Company_Name, @id = "txtCustomerName", @class = "form-control" })
                                        @*@Html.ValidationMessageFor(model => model.Company_Name, null, new { style = "color:red" })*@
                                        <label id="lblCCompanyNameMsg" style="color:red;display:none"></label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Address<span class="required" style="color: red; margin-left: 2px">*</span></label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.Address, new { @class = "form-control", @id = "txtAddress" })
                                        @*@Html.ValidationMessageFor(model => model.Address, null, new { style = "color:red" })*@
                                        <label id="lblCCompanyAddressMsg" style="color:red;display:none"></label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Address2</label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.Address_2, new { @class = "form-control", @id = "txtAddress1" })
                                        <label id="lblCCompanyAddressMsg1" style="color:red;display:none"></label>

                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Pincode<span class="required" style="color: red; margin-left: 2px">*</span></label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.Post_Code, new { @id = "txtPincode", @class = "form-control" })
                                        @*@Html.ValidationMessageFor(model => model.Post_Code, null, new { style = "color:red" })*@
                                        <label id="lblCCompanyPincodeMsg" style="color:red;display:none"></label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Area<span class="required" style="color:red;margin-left:2px">*</span></label>
                                    <div class="col-sm-9">
                                        <input type="hidden" id="hfAreaCode" value="@ViewBag.Area_Code" />
                                        @Html.DropDownListFor(model => model.Area_Code, Enumerable.Empty<SelectListItem>(), new { @id = "ddlArea", @class = "form-select" })
                                        <label id="lblCCompanyAreaMsg" style="color:red;display:none"></label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">City</label>
                                    <div class="col-sm-9">
                                        <input type="hidden" id="hfPostCode" value="@ViewBag.Post_Code" />
                                        @*@Html.DropDownListFor(model => model.Post_Code, Enumerable.Empty<SelectListItem>(), new { @id = "ddlCity", @class = "form-select" })*@
                                        @*<input type="text" id="txtCity" class="form-control" />*@
                                        @Html.TextBoxFor(model => model.City, new { @id = "txtCity", @class = "form-control" })
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">District</label>
                                    <div class="col-sm-9">
                                        <input type="hidden" id="hfDistrict" value="@ViewBag.District" />
                                        @*@Html.DropDownListFor(model => model.District, Enumerable.Empty<SelectListItem>(), new { @id = "ddlDistrict", @class = "form-select" })*@
                                        @*<input type="text" id="txtDistrict" class="form-control" />*@
                                        @Html.TextBoxFor(model => model.District, new { @id = "txtDistrict", @class = "form-control" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">State</label>
                                    <div class="col-sm-9">
                                        <input type="hidden" id="hfStateCode" value="@ViewBag.State_Code" />
                                        @*@Html.DropDownListFor(model => model.State_Code, Enumerable.Empty<SelectListItem>(), new { @id = "ddlState", @class = "form-select" })*@
                                        @*<input type="text" id="txtState" class="form-control" />*@
                                        @Html.TextBoxFor(model => model.State_Code, new { @id = "txtState", @class = "form-control" })
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Country</label>
                                    <div class="col-sm-9">
                                        <input type="hidden" id="hfCountryCode" value="@ViewBag.Country_Region_Code" />
                                        @*@Html.DropDownListFor(model => model.Country_Region_Code, Enumerable.Empty<SelectListItem>(), new { @id = "ddlCountry", @class = "form-select" })*@
                                        @*<input type="text" id="txtCountry" class="form-control" />*@
                                        @Html.TextBoxFor(model => model.Country_Region_Code, new { @id = "txtCountry", @class = "form-control" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Email<span class="required" style="color: red; margin-left: 2px">*</span></label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.E_Mail, new { @class = "form-control", @id = "txtCompanyEmail" })
                                        @*@Html.ValidationMessageFor(model => model.E_Mail, null, new { style = "color:red" })*@
                                        <label id="lblCCompanyEmailMsg" style="color:red;display:none"></label>
                                    </div>
                                    @*<div class="col-sm-1">
                                            <i class="bx bx-mail-send"></i>
                                        </div>*@
                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">URL</label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.PCPL_URL, new { @class = "form-control" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Phone No</label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.Phone_No, new { @class = "form-control", @id = "txtPhoneNo" })
                                        @*@Html.ValidationMessageFor(model => model.Phone_No, null, new { style = "color:red" })*@
                                        <label id="lblCCompanyPhoneNoMsg" style="color:red;display:none"></label>
                                    </div>
                                    @*<div class="col-sm-1">
                                            <i class="bx bx-phone-call"></i>
                                            <i class="bx bx-message"></i>
                                        </div>*@
                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Industry Group</label>
                                    <div class="col-sm-9">
                                        <input type="hidden" id="hfIndustryNo" value="@ViewBag.Industry_No" />
                                        @Html.DropDownListFor(model => model.Industry_No, Enumerable.Empty<SelectListItem>(), new { @id = "ddlIndustry", @class = "form-select" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Business Type</label>
                                    <div class="col-sm-9">
                                        <input type="hidden" id="hfBusinessTypeNo" value="@ViewBag.Business_Type_No" />
                                        @Html.DropDownListFor(model => model.Business_Type_No, Enumerable.Empty<SelectListItem>(), new { @id = "ddlBusinessType", @class = "form-select" })
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Sales Person<span class="required" style="color: red; margin-left: 2px">*</span></label>
                                    <div class="col-sm-9">
                                        <input type="hidden" id="hfSalespersonCode" value="@ViewBag.Salesperson_Code" />
                                        @*<input type="hidden" id="hfSelectedSPCode" value="" />*@
                                        @Html.HiddenFor(model => model.Salesperson_Code, new { @id = "hfSelectedSPCode" })
                                        <select id="ddlSalesPerson" class="form-select"></select>
                                        @*@Html.DropDownListFor(model => model.Salesperson_Code, Enumerable.Empty<SelectListItem>(), new { @id = "ddlSalesPerson", @class = "form-select" })*@
                                        @Html.ValidationMessageFor(model => model.Salesperson_Code, null, new { style = "color:red" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Secondary SP</label>
                                    <div class="col-sm-9">
                                        <input type="hidden" id="hfSecondarySPCode" value="@ViewBag.PCPL_Secondary_SP_Code" />
                                        @Html.DropDownListFor(model => model.PCPL_Secondary_SP_Code, Enumerable.Empty<SelectListItem>(), new { @id = "ddlSecondarySP", @class = "form-select" })
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">PAN No</label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.P_A_N_No, new { @class = "form-control", @id = "PanNo" })
                                        @*@Html.ValidationMessageFor(model => model.P_A_N_No, null, new { style = "color:red" })*@
                                        <label id="lblCCompanyPANNoMsg" style="color:red;display:none"></label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">GST No</label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.GST_Registration_No, new { @class = "form-control", @id = "GSTNo" })
                                        @*@Html.ValidationMessageFor(model => model.GST_Registration_No, null, new { style = "color:red" })*@
                                        <label id="lblCCompanyGSTNoMsg" style="color:red;display:none"></label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Assessee Code</label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.Assessee_Code, new { @class = "form-control", @id = "txtAssesseeCode" })
                                        @*@Html.ValidationMessageFor(model => model.P_A_N_No, null, new { style = "color:red" })*@
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Credit Limit</label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.Credit_Limit, new { Value = "0", @class = "form-control", @id = "txtCreditLimit", disabled = "disabled" })
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">

                                    <label class="col-sm-3 col-form-label">Source Of Contact</label>
                                    <div class="col-sm-9">
                                        <input type="hidden" id="hfSourceOfContactNo" value="@ViewBag.Source_Of_Contact_No" />
                                        @Html.DropDownListFor(model => model.Source_Of_Contact_No, Enumerable.Empty<SelectListItem>(), new { @id = "ddlSourceOfContact", @class = "form-select" })
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-6">
                            </div>
                        </div>

                        <h6 class="mb-0 font-weight-bold">Contact Person</h6>
                        <hr />

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Name<span class="required" style="color:red;margin-left:2px">*</span></label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.Contact_Name, new { @class = "form-control", @id = "txtContactName", @Name = "txtContactName" })
                                        @Html.ValidationMessageFor(model => model.Contact_Name, null, new { style = "color:red" })
                                        <label id="lblContactNameMsg" style="color:red;display:none"></label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Mobile No<span class="required" style="color: red; margin-left: 2px">*</span></label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.Mobile_Phone_No, new { Value = "", @class = "form-control", @id = "txtMobilePhoneNo", @Name = "txtMobilePhoneNo" })
                                        @Html.ValidationMessageFor(model => model.Mobile_Phone_No, null, new { style = "color:red" })
                                        <label id="lblContactMobileMsg" style="color:red;display:none"></label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    @*<label class="col-sm-3 col-form-label">Email<span class="required" style="color:red;margin-left:2px">*</span></label>*@
                                    <label class="col-sm-3 col-form-label">Email<span class="required" style="color:red;margin-left:2px">*</span></label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.Contact_EMail, new { @class = "form-control", @id = "txtContactEmail", @Name = "txtContactEmail" })
                                        @Html.ValidationMessageFor(model => model.Contact_EMail, null, new { style = "color:red" })
                                        <label id="lblContactEmailMsg" style="color:red;display:none"></label>
                                    </div>
                                </div>

                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Department<span class="required" style="color:red;margin-left:2px">*</span></label>
                                    <div class="col-sm-9">
                                        <input type="hidden" id="hfDepartmentCode" value="@ViewBag.PCPL_Department_Code" />
                                        @Html.DropDownListFor(model => model.PCPL_Department_Code, Enumerable.Empty<SelectListItem>(), new { @id = "ddlDepartment", @class = "form-select", @Name = "ddlDepartment" })
                                        <label id="lblDeptMsg" style="color:red;display:none"></label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Job Responsibility<span class="required" style="color:red;margin-left:2px">*</span></label>
                                    <div class="col-sm-9">
                                        @Html.TextBoxFor(model => model.PCPL_Job_Responsibility, new { @class = "form-control", @id = "txtJobResponsibility", @Name = "txtJobResponsibility" })
                                        @Html.ValidationMessageFor(model => model.PCPL_Job_Responsibility, null, new { style = "color:red" })
                                        <label id="lblJobResponsibilityMsg" style="color:red;display:none"></label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Allow Login</label>
                                    <div class="col-sm-9">
                                        @Html.CheckBoxFor(model => model.PCPL_Allow_Login, new { @id = "chkAllowLogin" })
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Enable OTP On Login</label>
                                    <div class="col-sm-9">
                                        @Html.CheckBoxFor(model => model.PCPL_Enable_OTP_On_Login, new { @id = "chkEnableOTPOnLogin", @checked = "checked" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row mb-3">
                                    <label class="col-sm-3 col-form-label">Is Primary</label>
                                    <div class="col-sm-9">
                                        @Html.CheckBoxFor(model => model.Is_Primary, new { @id = "chkIsPrimary" })
                                    </div>
                                </div>
                            </div>
                        </div>

                        <input type="hidden" id="hdfCompanyNo" value="@Session["CompanyNo"].ToString()" />

                        @if (ViewBag.Contactscount > 0)
                        {
                            <!-- -->

                            <div class="row g-3">
                                <div class="col-md-12" align="right">
                                    <div class="row mb-3">
                                        <div class="col-sm-12">
                                            <button id="btnAddContactSpinner" class="btn btn-primary" type="button" disabled style="display:none">
                                                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                                <span class="visually-hidden">Loading...</span>
                                            </button>
                                            &nbsp;
                                            <button id="btnAddContact" class="btn btn-secondary btn-sm" type="button">Add</button>  @*Other Contact Person*@
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br />

                            <div class="row g-3">
                                <div class="col-md-12">
                                    <div class="row mb-3" align="right">
                                        <div class="card-box table-responsive">
                                            <center>
                                                <table class="table table-striped" style="width:70%">
                                                    <thead>
                                                        <tr>
                                                            <th></th>
                                                            <th>Name</th>
                                                            <th>Mobile</th>
                                                            <th>Email</th>
                                                            <th hidden></th>
                                                            <th>Department</th>
                                                            <th>Job Responsibility</th>
                                                            <th>Allow Login</th>
                                                            <th>Is Primary</th>
                                                            <th hidden>DeptCode</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        @foreach (PrakashCRM.Data.Models.SPContactResponse contact in ViewBag.Contacts)
                                                        {
                                                            <tr>
                                                                <td>
                                                                    <a class="EditContactCls" onclick="EditContact(this);"><i class="bx bx-pencil"></i></a>
                                                                    &nbsp;&nbsp;
                                                                    <a class="DeleteContactCls" onclick="DeleteContact(this);"><i class="bx bx-trash"></i></a>
                                                                </td>
                                                                <td hidden name="contactNo">@contact.No</td>
                                                                <td name="contactName">@contact.Name</td>
                                                                <td name="contactMobile">@contact.Mobile_Phone_No</td>
                                                                <td name="contactEmail">@contact.E_Mail</td>
                                                                <td hidden name="contactCompanyNo">@contact.Company_No</td>
                                                                <td name="contactDepartment">@contact.PCPL_Department_Name</td>
                                                                <td name="contactJob">@contact.PCPL_Job_Responsibility</td>
                                                                @if (contact.PCPL_Allow_Login)
                                                                {
                                                                    <td name="contactAllowLogin">Yes</td>
                                                                }
                                                                else
                                                                {
                                                                    <td name="contactAllowLogin">No</td>
                                                                }

                                                                @if (contact.PCPL_Enable_OTP_On_Login)
                                                                {
                                                                    <td hidden name="contactEnableOTP">Yes</td>
                                                                }
                                                                else
                                                                {
                                                                    <td hidden name="contactEnableOTP">No</td>
                                                                }
                                                                @if (contact.Is_Primary)
                                                                {
                                                                    <td name="contactIsPrimary">Yes</td>
                                                                }
                                                                else
                                                                {
                                                                    <td name="contactIsPrimary">No</td>
                                                                }
                                                                <td hidden name="contactDeptCode">@contact.PCPL_Department_Code</td>
                                                            </tr>
                                                        }
                                                    </tbody>
                                                </table>
                                            </center>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        }

                        @if (Convert.ToBoolean(Session["isCompanyContactEdit"]) == true)
                        {
                            <h6 class="mb-0 font-weight-bold">Contact Products</h6>
                            <hr />

                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="row mb-3">
                                        <input id="hfCCompanyNo" value="@Session["CompanyNo"].ToString()" style="display:none" />
                                        <input id="hfCustomerNo" value="@ViewBag.CustomerNo" style="display:none" />
                                        <label class="col-sm-3 col-form-label">Product</label>
                                        <div class="col-sm-9">
                                            <select id="ddlProducts" class="form-select">
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="row mb-3">
                                        <div class="col-sm-3">
                                            <button type="button" id="btnAddProd" class="btn btn-secondary">Add</button>
                                            &nbsp;
                                            <button id="btnAddContactProdSpinner" class="btn btn-primary" type="button" disabled style="display:none">
                                                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                                <span class="visually-hidden">Loading...</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            if (ViewBag.ContactProductsCnt > 0)
                            {
                                <div class="row g-3">
                                    <div class="col-md-12">
                                        <div class="row mb-3" align="right">
                                            <div class="card-box table-responsive verticalScroll">
                                                <center>
                                                    <table id="tblContactProds" class="table table-striped" style="width:30%">
                                                        <thead>
                                                            <tr>
                                                                <th></th>
                                                                <th hidden></th>
                                                                <th hidden></th>
                                                                <th>ProdNo</th>
                                                                <th>Product</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            @foreach (PrakashCRM.Data.Models.SPContactProducts contactProduct in ViewBag.ContactProducts)
                                                            {
                                                                <tr>
                                                                    <td>
                                                                        <a class="DeleteContactProdCls" style="cursor:pointer" onclick="DeleteProduct(this);"><i class="bx bx-trash"></i></a>
                                                                    </td>
                                                                    <td hidden name="contactProdNo">@contactProduct.No</td>
                                                                    <td hidden name="contactNo">@contactProduct.Contact_No</td>
                                                                    <td name="itemNo">@contactProduct.Item_No</td>
                                                                    <td name="itemName">@contactProduct.Item_Name</td>
                                                                </tr>
                                                            }
                                                        </tbody>
                                                    </table>
                                                </center>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }

                            @*<h6 class="mb-0 font-weight-bold">Daily Visit Plan</h6>
                                <hr />

                                <h6 class="mb-0 font-weight-bold">Business Plan</h6>
                                <hr />

                                <h6 class="mb-0 font-weight-bold">Sales Quote</h6>
                                <hr />*@

                            <!-- -->
                            <div class="card">
                                <div class="card-body">
                                    <div class="accordion accordion-flush" id="accordionFlushExample">
                                        <div class="accordion-item">
                                            <h2 class="accordion-header" id="flush-DailyVisitPlan">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseDailyVisitPlan" aria-expanded="false" aria-controls="flush-collapseDailyVisitPlan">
                                                    Daily Visit Plan
                                                </button>
                                            </h2>
                                            <div id="flush-collapseDailyVisitPlan" class="accordion-collapse collapse" aria-labelledby="flush-DailyVisitPlan" data-bs-parent="#accordionFlushExample">
                                                <div class="accordion-body">
                                                    <div class="row g-3">
                                                        <div class="col-md-3">
                                                            <div class="row mb-3">
                                                                <label class="col-sm-3 col-form-label">From Date</label>
                                                                <div class="col-sm-9">
                                                                    <input type="date" id="txtDailyVisitFDate" class="form-control" />
                                                                    <label id="lblDailyVisitFDateMsg" class="form-label" style="color:red;display:none">Please Select From Date</label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3">
                                                            <div class="row mb-3">
                                                                <label class="col-sm-3 col-form-label">To Date</label>
                                                                <div class="col-sm-9">
                                                                    <input type="date" id="txtDailyVisitTDate" class="form-control" />
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3">
                                                            <button id="btnDailyVisitListSpinner" class="btn btn-primary" type="button" disabled style="display:none">
                                                                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                                                <span class="visually-hidden">Loading...</span>
                                                            </button>
                                                            &nbsp;
                                                            <button id="btnDailyVisitShowAll" class="btn btn-primary" type="button">Show All</button>
                                                        </div>
                                                        <div class="col-md-3">
                                                        </div>
                                                    </div>
                                                    <br />
                                                    <div class="row g-3">
                                                        <div class="col-md-12 verticalScroll">
                                                            <div class="row mb-3">
                                                                <div class="col-sm-12">

                                                                    <table class="table mb-0 table-striped">
                                                                        <thead>
                                                                            <tr>
                                                                                <th>Date</th>
                                                                                <th>Type</th>
                                                                                <th>Sub Type</th>
                                                                                <th>Customer</th>
                                                                                <th>Contact Person</th>
                                                                                <th>Event</th>
                                                                                <th>Topic</th>
                                                                                <th>Visit Mode</th>
                                                                                <th>Feedback</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody id="tblContactDailyVisit">
                                                                        </tbody>
                                                                    </table>

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="accordion-item">
                                            <h2 class="accordion-header" id="flush-BusinessPlan">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseBusinessPlan" aria-expanded="false" aria-controls="flush-collapseBusinessPlan">
                                                    Business Plan
                                                </button>
                                            </h2>
                                            <div id="flush-collapseBusinessPlan" class="accordion-collapse collapse" aria-labelledby="flush-BusinessPlan" data-bs-parent="#accordionFlushExample">
                                                <div class="accordion-body">

                                                    <div class="row g-3">
                                                        <div class="col-md-4">
                                                            <table>
                                                                <tr>
                                                                    <td><label class="form-label">Financial Year:</label></td>
                                                                    <td>&nbsp;</td>
                                                                    <td><select id="ddlFinancialYear" class="form-select"></select></td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <br />
                                                    <div class="row g-3">
                                                        <div class="col-md-12 verticalScroll">
                                                            <div class="row mb-3">
                                                                <div class="col-sm-12">

                                                                    <table class="table mb-0 table-striped">
                                                                        <thead>
                                                                            <tr>
                                                                                <th hidden></th>
                                                                                <th>Product Name</th>
                                                                                <th colspan="4" scope="col" align="center" style="font-weight:bold">Prev. Financial Year (<label id="lblDetailsPrevYear"></label>)</th>
                                                                                <th colspan="4" scope="col" align="center" style="font-weight:bold">Financial Year (<label id="lblDetailsYearGrid"></label>)</th>
                                                                            </tr>
                                                                            <tr>
                                                                                <th hidden></th>
                                                                                <th></th>
                                                                                <th scope="col">Demand<br />Qty</th>
                                                                                <th scope="col">Target<br />Qty</th>
                                                                                <th scope="col">Achieved<br />Qty</th>
                                                                                <th scope="col">Last Year<br />Sale(&#8377;)</th>
                                                                                <th scope="col">Demand<br />Qty</th>
                                                                                <th scope="col">Target<br />Qty</th>
                                                                                <th scope="col">Avg Price</th>
                                                                                <th scope="col">Target<br />Revenue</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody id="tblDetailsContactBusinessPlan">
                                                                        </tbody>
                                                                    </table>

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <div class="accordion-item">
                                            <h2 class="accordion-header" id="flush-SalesQuote">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseSalesQuote" aria-expanded="false" aria-controls="flush-collapseSalesQuote">
                                                    Sales Quotes
                                                </button>
                                            </h2>
                                            <div id="flush-collapseSalesQuote" class="accordion-collapse collapse" aria-labelledby="flush-SalesQuote" data-bs-parent="#accordionFlushExample">
                                                <div class="accordion-body">
                                                    <div class="row g-3">
                                                        <div class="col-md-3">
                                                            <div class="row mb-3">
                                                                <label class="col-sm-3 col-form-label">From Date</label>
                                                                <div class="col-sm-9">
                                                                    <input type="date" id="txtSQListFromDate" class="form-control" />
                                                                    <label id="lblSQListFDateMsg" class="form-label" style="color:red;display:none">Please Select From Date</label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3">
                                                            <div class="row mb-3">
                                                                <label class="col-sm-3 col-form-label">To Date</label>
                                                                <div class="col-sm-9">
                                                                    <input type="date" id="txtSQListToDate" class="form-control" />
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3">
                                                            <button id="btnSQListSpinner" class="btn btn-primary" type="button" disabled style="display:none">
                                                                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                                                <span class="visually-hidden">Loading...</span>
                                                            </button>
                                                            &nbsp;
                                                            <button id="btnSQListShowAll" class="btn btn-primary" type="button">Show All</button>
                                                        </div>
                                                        <div class="col-md-3">
                                                        </div>
                                                    </div>
                                                    <div class="row g-3">
                                                        <div class="col-md-12">
                                                            <div class="card-box table-responsive verticalScroll">
                                                                <center>
                                                                    <table class="table table-striped" style="width:30%">
                                                                        <thead>
                                                                            <tr>
                                                                                <th>Quote No</th>
                                                                                <th>Quote Date</th>
                                                                                <th>Customer</th>
                                                                                <th>Payment Terms</th>
                                                                                <th>Schedule Order</th>
                                                                                <th>Products</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody id="tblContactSQ">
                                                                        </tbody>
                                                                    </table>
                                                                </center>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <!-- -->
                        }
                        <!-- -->
                    </div>
                </div>
                <div class="toolbar">
                    <div class=" text-end g-3">
                        <input id="getServiceApiUrl" value="@System.Configuration.ConfigurationManager.AppSettings["ServiceApiUrl"].ToString()" style="display:none" />
                        <input type="hidden" id="hdfContactNo" />
                        <input type="hidden" id="hdfContactCompanyNo" />
                        <input type="hidden" id="hdnCompanyNo" value="@Session["CompanyNo"]" />
                        <input type="hidden" id="hdnCompanyContactAction" value="@Session["CompanyContactAction"]" />
                        <input type="hidden" id="hdnCompanyContactActionErr" value="@Session["CompanyContactActionErr"]" />
                        <input type="hidden" id="hfIsCompanyContactEdit" value="@Session["isCompanyContactEdit"].ToString()" />
                        <button id="btnSaveSpinner" class="btn btn-primary" type="button" disabled style="display:none">
                            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                            <span class="visually-hidden">Loading...</span>
                        </button>
                        &nbsp;
                        @*ShowProcessImg()*@
                        <button id="btnSave" class="btn btn-success" onclick="return CheckContactValues()" type="submit"><i class="bx bxs-save"></i> Save</button>
                        &nbsp;
                        <a href="/SPContacts/ContactCompanyList" class="btn btn-danger"><i class="lni lni-close"></i> Cancel</a>
                        &nbsp;
                        <button id="btnCreateSQ" type="button" class="btn btn-primary" style="display:none">Create SalesQuote</button>
                    </div>
                </div>

            }
        </div>
    </div>
</div>
<div class="modal" id="modalSQProds" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="dvSQProds" style="display:none">

                    <div class="row g-3">
                        <div class="col-md-12">
                            <table>
                                <tr>
                                    <td><label style="font-weight:bold">Sales Quote No: </label></td>
                                    <td>&nbsp;</td>
                                    <td><label id="lblSQNo"></label></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <br />
                    <div class="row g-3">
                        <div class="col-md-12">
                            <div class="row mb-3">
                                <div class="col-sm-12">
                                    <table class="table mb-0 table-striped">
                                        <thead>
                                            <tr>
                                                <th scope="col">Product No</th>
                                                <th scope="col">Product Name</th>
                                                <th scope="col">Quantity</th>
                                                <th scope="col">Packing Style</th>
                                                <th scope="col">UOM</th>
                                                <th scope="col">MRP</th>
                                                <th scope="col">Unit Price(Sales Price)</th>
                                                <th scope="col">Drop Shipment</th>
                                                @*<th scope="col">Vendor</th>*@
                                            </tr>
                                        </thead>
                                        <tbody id="tblContactSQProds">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal" id="modalCompanyDetails" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Contact Company Details</h5>
                <button id="btnCloseCompanyDetails" type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">

                <div class="row g-3">
                    <div class="col-md-12">
                        <table>
                            <tr>
                                <td><label style="font-weight:bold">Company Name: </label></td>
                                <td>&nbsp;</td>
                                <td><label id="lblCompanyName"></label></td>
                            </tr>
                            <tr>
                                <td><label style="font-weight:bold">Salesperson Code: </label></td>
                                <td>&nbsp;</td>
                                <td><label id="lblSPCode"></label></td>
                            </tr>
                            <tr>
                                <td><label style="font-weight:bold">Company Address: </label></td>
                                <td>&nbsp;</td>
                                <td><label id="lblCompanyAddress"></label></td>
                            </tr>
                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
</div>
<div class="modal" id="modalDeleteContactProdMsg" tabindex="-1" aria-hidden="true" style="display:none">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Delete Product</h5>
                <button id="btnCloseDeleteProdMsg" type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <center>
                    <img id="resIcon" src="~/Layout/assets/images/appImages/Icon-1.png" />
                    <br />
                    <label id="lblDeleteProdMsg" class="form-label"></label>
                </center>
            </div>
        </div>
    </div>
</div>
<div class="modal" id="modalErrMsg" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" style="color:red">Error</h5>
                <button id="btnCloseModalErrMsg" type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" style="color:red" align="center">
                <img src="~/Layout/assets/images/appImages/CancelIcon.png" />
                <br /><br />
                <h6 id="modalErrDetails" style="color:red"></h6>
            </div>
        </div>
    </div>
</div>


@Scripts.Render("~/bundles/jquery")
<script src="~/Scripts/appjs/CompanyContactCard.js"></script>
<script src='@Url.Content("~/Scripts/jquery.validate.js")' type='text/javascript'></script>
<script src='@Url.Content("~/Scripts/jquery.validate.unobtrusive.js")' type='text/javascript'></script>
@*<script src="~/Layout/vendors/raphael/raphael.min.js"></script>
    <script src="~/Layout/vendors/morris.js/morris.min.js"></script>*@
<script>
    $(document).ready(function () {

        $('#btnCreateSQ').click(function () {

             //alert($('#hdnCompanyNo').val() + " " + $('#txtCustomerName').val());
            //window.location.href = "/SPSalesQuotes/SalesQuote?CompanyNo=" + $('#hdnCompanyNo').val() + "&CompanyName=" + $('#txtCustomerName').val();
            window.location.replace('@Url.Action("SalesQuote", "SPSalesQuotes")?CompanyNo=' + $('#hdnCompanyNo').val() + "&CompanyName=" + $('#txtCustomerName').val());

        });

    });

    function BindCompany() {

        //$.get(apiUrl + 'GetAllCompanyForDDL?SPCode=' + $('#hfSalespersonCode').val(), function (data)
        $.get(apiUrl + 'GetAllCompanyForDDL', function (data) {

            if (data != null) {

                var str1 = "";
                var i;
                for (i = 0; i < data.length; i++) {
                    var address_ = data[i].Address + " " + data[i].Address_2 + " " + data[i].Area + "," + data[i].City + "-" + data[i].Post_Code;
                    str1 = str1 + '"' + data[i].No + '_' + data[i].Salesperson_Code + '_' + address_ + '"' + ":" + '"' + data[i].Name + '"' + ","
                }
                str1 = str1.substring(0, str1.length - 1);
                str1 = "{" + str1 + "}";

                let objFromStr = JSON.parse(str1);
                var company = objFromStr;// { AA: "Abc", AO: "Abc", BB: "Bcd", CC: "Cde", DD: "Def", EE: "Efg", EH: "Ester", FF: "Fgh", GG: "Ghi"};
                var companyArray = $.map(company, function (value, key) {
                    return {
                        value: value,
                        data: key
                    };
                });

                $('#txtCustomerName').autocomplete({
                    lookup: companyArray,
                    onSelect: function (selecteditem) {

                        const companyDetails = selecteditem.data.split('_');
                        if (companyDetails[1] == $('#hfSalespersonCode').val()) {
                            window.location.href = "/SPContacts/CompanyContactCard?No=" + companyDetails[0];
                        }
                        else {

                            $('#modalCompanyDetails').css('display', 'block');
                            $('#lblCompanyName').text(selecteditem.value);
                            $('#lblSPCode').text(companyDetails[1]);
                            $('#lblCompanyAddress').text(companyDetails[2]);
                        }
                    },

                });

            }
        });

    }
</script>